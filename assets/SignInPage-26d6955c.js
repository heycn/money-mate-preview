import{d as k,e as S,u as E,f as I,b as n,j as a,c as q,I as z,l as C,g as x,v as g,h as f}from"./index-0ab17bf9.js";import{u as D}from"./useTitle-eae6efdf.js";const L="/money-mate-preview/assets/bottom-8aef7a7c.svg",M=k(s=>({data:{email:"test01@gmail.com",code:"123456"},error:{email:[],code:[]},setData:e=>{s(r=>({...r,data:{...r.data,...e}}))},setError:e=>{s(r=>({...r,error:{...e}}))}})),_=s=>{var p,u;D(s==null?void 0:s.title);const{data:e,error:r,setData:m,setError:c}=M(),h=S(),{post:l}=E({showLoading:!0}),y=t=>{var o,i;throw c(((i=(o=t.response)==null?void 0:o.data)==null?void 0:i.errors)??{}),r},[v]=I(),d=v.get("from")||"/items",w=async t=>{t.preventDefault();const o=g(e,[{key:"email",type:"required",message:"没输入邮箱地址!"},{key:"email",type:"pattern",regex:/^.+@.+$/,message:"邮箱格式不正确!"},{key:"code",type:"required",message:"没输入验证码!"},{key:"code",type:"length",min:6,max:6,message:"验证码必须是6位!"}]);if(c(o),!f(o)){const j=(await l("/api/v1/session",e).catch(y)).data.jwt;localStorage.setItem("jwt",j),h(d,{replace:!0})}},b=async()=>{const t=g({email:e.email},[{key:"email",type:"required",message:"没输入邮箱地址!"},{key:"email",type:"pattern",regex:/^.+@.+$/,message:"邮箱格式不正确!"}]);if(c(t),f(t))throw new Error("表单出错");return await l("/api/v1/validation_codes",{email:e.email})};return n("div",{fixed:"","left-0":"","top-0":"","w-screen":"","h-screen":"",flex:"","flex-col":"","justify-between":"",bg:"#f6f6f6",children:[n("div",{"px-26px":"",z:"[calc(var(--z-menu))]",children:[n("header",{"py-16px":"",flex:"","items-center":"","text-18px":"",color:"#5eb39e",children:[a(q,{to:d,replace:!0,children:a(z,{name:"back"})}),a("span",{"ml-4px":"",children:"返回"})]}),n("div",{my:"1/7","text-center":"",children:[a("img",{"h-48px":"",src:C}),a("h2",{"pt-16px":"","text-22px":"",text:"#5eb39e",children:"登录 MoneyMate"})]}),n("form",{flex:"","flex-col":"",onSubmit:w,children:[a(x,{type:"email",value:e.email,onChange:t=>m({email:t}),error:(p=r.email)==null?void 0:p[0]}),a(x,{type:"sms_code",value:e.code,onChange:t=>m({code:t}),request:b,error:(u=r.code)==null?void 0:u[0]}),a("button",{"mt-64px":"","m-btn":"",type:"submit",children:"登录"})]})]}),a("img",{className:"fixed bottom--32px left-0 w-100%",src:L,z:"[calc(var(--z-menu)-1)]"})]})};export{_ as SignInPage,_ as default};
